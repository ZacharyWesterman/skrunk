
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>application.db package &#8212; Skrunk Server 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'application.db';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="application.exceptions package" href="application.exceptions.html" />
    <link rel="prev" title="application package" href="application.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Skrunk Server 1.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="modules.html">
    application
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="modules.html">
    application
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="application.html">application package</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">application.db package</a></li>
<li class="toctree-l2"><a class="reference internal" href="application.exceptions.html">application.exceptions package</a></li>
<li class="toctree-l2"><a class="reference internal" href="application.integrations.html">application.integrations package</a></li>
<li class="toctree-l2"><a class="reference internal" href="application.monkeypatch.html">application.monkeypatch package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="application.resolvers.html">application.resolvers package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="application.resolvers.mutation.html">application.resolvers.mutation package</a></li>
<li class="toctree-l3"><a class="reference internal" href="application.resolvers.query.html">application.resolvers.query package</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="application.routes.html">application.routes package</a></li>
<li class="toctree-l2"><a class="reference internal" href="application.scalars.html">application.scalars package</a></li>
<li class="toctree-l2"><a class="reference internal" href="application.types.html">application.types package</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="modules.html" class="nav-link">application</a></li>
    
    
    <li class="breadcrumb-item"><a href="application.html" class="nav-link">application package</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">application.db package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="application-db-package">
<h1>application.db package<a class="headerlink" href="#application-db-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-application.db.apikeys">
<span id="application-db-apikeys-module"></span><h2>application.db.apikeys module<a class="headerlink" href="#module-application.db.apikeys" title="Link to this heading">#</a></h2>
<p>application.db.apikeys</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.apikeys.delete_api_key">
<span class="sig-prename descclassname"><span class="pre">application.db.apikeys.</span></span><span class="sig-name descname"><span class="pre">delete_api_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.apikeys.delete_api_key" title="Link to this definition">#</a></dt>
<dd><p>Deletes an API key from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – The API key to be deleted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the API key was successfully deleted, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.apikeys.get_api_keys">
<span class="sig-prename descclassname"><span class="pre">application.db.apikeys.</span></span><span class="sig-name descname"><span class="pre">get_api_keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.apikeys.get_api_keys" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of API keys from the database.</p>
<p>This function queries the database to find API keys, sorts them by the
‘created’ field in descending order, and limits the result to 200 entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of API keys sorted by creation date in descending order.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.apikeys.new_api_key">
<span class="sig-prename descclassname"><span class="pre">application.db.apikeys.</span></span><span class="sig-name descname"><span class="pre">new_api_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permissions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.apikeys.new_api_key" title="Link to this definition">#</a></dt>
<dd><p>Generate a new API key with the given description and permissions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>description</strong> (<em>str</em>) – A description for the new API key.</p></li>
<li><p><strong>permissions</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of permissions associated with the API key.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated API key.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.apikeys.valid_api_key">
<span class="sig-prename descclassname"><span class="pre">application.db.apikeys.</span></span><span class="sig-name descname"><span class="pre">valid_api_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.apikeys.valid_api_key" title="Link to this definition">#</a></dt>
<dd><p>Checks if the provided API key is valid by searching for it in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – The API key to be validated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the API key is found in the database, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.blob">
<span id="application-db-blob-module"></span><h2>application.db.blob module<a class="headerlink" href="#module-application.db.blob" title="Link to this heading">#</a></h2>
<p>This module provides functions to manage blobs in the database, including creating,
updating, deleting, and retrieving blob data. It also handles file uploads,
packing and unpacking of ZIP files, and generating previews for various file types.</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.add_reference">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">add_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.add_reference" title="Link to this definition">#</a></dt>
<dd><p>Increment the ‘references’ field of a document in the database by 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The unique identifier of the document to update.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.build_blob_query">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">build_blob_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.build_blob_query" title="Link to this definition">#</a></dt>
<dd><p>Builds a MongoDB query for searching blobs based on the provided filter and user ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.blobsearchfilter.BlobSearchFilter" title="application.types.blobsearchfilter.BlobSearchFilter"><em>BlobSearchFilter</em></a>) – A filter object containing various search criteria.</p></li>
<li><p><strong>user_id</strong> (<em>ObjectId</em>) – The ID of the user making the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A MongoDB query dictionary constructed based on the provided filter and user ID.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<dl class="simple">
<dt>The filter object can contain the following keys:</dt><dd><ul class="simple">
<li><p>tag_expr (str): A tag expression to filter blobs by tags.</p></li>
<li><p>creator (str or list): A username or a list of usernames to filter blobs by their creators.</p></li>
<li><p>begin_date (datetime): The start date to filter blobs created after this date.</p></li>
<li><p>end_date (datetime): The end date to filter blobs created before this date.</p></li>
<li><p>name (str): A regex pattern to filter blobs by their names.</p></li>
<li><p>ephemeral (bool): A boolean to filter blobs by their ephemeral status.</p></li>
</ul>
</dd>
</dl>
<p>The query will always include blobs that are either not hidden or created by the user.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.cancel_zip">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">cancel_zip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blob_zip_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.cancel_zip" title="Link to this definition">#</a></dt>
<dd><p>Cancels the zip operation for the given blob_zip_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>blob_zip_id</strong> (<em>str</em>) – The ID of the blob zip operation to cancel.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>BlobDoesNotExistError</strong></a> – If the blob_zip_id does not exist in the _zip_progress.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the progress and item of the zip operation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.count_blobs">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">count_blobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.count_blobs" title="Link to this definition">#</a></dt>
<dd><p>Count the number of blobs in the database that match the given filter and user ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.blobsearchfilter.BlobSearchFilter" title="application.types.blobsearchfilter.BlobSearchFilter"><em>BlobSearchFilter</em></a>) – The filter criteria to apply to the blob search.</p></li>
<li><p><strong>user_id</strong> (<em>ObjectId</em>) – The ID of the user whose blobs are being counted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of blobs that match the filter criteria for the given user.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.count_tag_uses">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">count_tag_uses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_ids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.count_tag_uses" title="Link to this definition">#</a></dt>
<dd><p>Count the number of documents in the database that contain a specific tag
and are created by any of the specified users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tag</strong> (<em>str</em>) – The tag to search for in the documents.</p></li>
<li><p><strong>user_ids</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of user identifiers to filter the documents by their creators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The count of documents that match the specified tag and creators.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.create_blob">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">create_blob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ephemeral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.create_blob" title="Link to this definition">#</a></dt>
<dd><p>Creates a new blob entry in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the blob, typically the filename.</p></li>
<li><p><strong>tags</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of tags associated with the blob. Defaults to an empty list.</p></li>
<li><p><strong>hidden</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag indicating if the blob should be hidden. Defaults to False.</p></li>
<li><p><strong>ephemeral</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag indicating if the blob is ephemeral. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the inserted blob’s ID and the file extension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[str, str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.create_blob_previews">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">create_blob_previews</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uploaded_blobs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.create_blob_previews" title="Link to this definition">#</a></dt>
<dd><p>Generates and stores preview and thumbnail images for uploaded blobs based on their file type.</p>
<p>For each blob in the provided list:
- If the blob is an image, creates a preview (512px) and a thumbnail (128px).
- If the blob is a 3D model, generates a preview that can be viewed in browser.
- If the blob is a video, generates a preview image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>uploaded_blobs</strong> (<em>list</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>,</em><em>str</em><em>]</em><em>]</em>) – A list of dictionaries containing blob IDs and extensions.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.create_preview_model">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">create_preview_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preview_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.create_preview_model" title="Link to this definition">#</a></dt>
<dd><p>Creates a preview model from a blob and updates the database with the preview information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – The file path to the blob.</p></li>
<li><p><strong>preview_id</strong> (<em>str</em>) – The unique identifier for the preview.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.create_preview_video">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">create_preview_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preview_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.create_preview_video" title="Link to this definition">#</a></dt>
<dd><p>Creates a preview video from the first frame of the given video blob
and updates the database with the preview information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – The file path to the video blob.</p></li>
<li><p><strong>preview_id</strong> (<em>str</em>) – The unique identifier for the preview.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.delete_blob">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">delete_blob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blob_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.delete_blob" title="Link to this definition">#</a></dt>
<dd><p>Deletes a blob from the database and the file system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>blob_id</strong> (<em>str</em>) – The ID of the blob to be deleted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data of the deleted blob.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>BlobDoesNotExistError</strong></a> – If the blob with the given ID does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.file_info">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">file_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.file_info" title="Link to this definition">#</a></dt>
<dd><p>Calculate the MD5 checksum and size of a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The path to the file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the size of the file in bytes (int) and the MD5 checksum (str).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.get_blob_data">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">get_blob_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.get_blob_data" title="Link to this definition">#</a></dt>
<dd><p>Retrieve blob data from the database by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The ID of the blob to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary containing the blob data. If the blob exists, the dictionary</dt><dd><p>will include the blob’s ID and the creator’s username. If the creator does
not exist, the creator field will contain the creator’s ID as a string.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>exceptions.BlobDoesNotExistError</strong></a> – If the blob with the given ID does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.get_blobs">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">get_blobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorting</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.get_blobs" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of blobs from the database based on
the provided filter, pagination, and sorting options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.blobsearchfilter.BlobSearchFilter" title="application.types.blobsearchfilter.BlobSearchFilter"><em>BlobSearchFilter</em></a>) – The filter criteria to apply to the blob search.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting index for pagination.</p></li>
<li><p><strong>count</strong> (<em>int</em>) – The number of blobs to retrieve.</p></li>
<li><p><strong>sorting</strong> (<a class="reference internal" href="application.types.html#application.types.sorting.Sorting" title="application.types.sorting.Sorting"><em>Sorting</em></a>) – The sorting options for the blobs.</p></li>
<li><p><strong>user_id</strong> (<em>ObjectId</em>) – The ID of the user performing the search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of blobs matching the search criteria.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.get_tags_from_mime">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">get_tags_from_mime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mime</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.get_tags_from_mime" title="Link to this definition">#</a></dt>
<dd><p>Extracts tags from a MIME type string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mime</strong> (<em>str</em>) – The MIME type string to be split into tags.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of tags obtained by splitting the MIME type string by ‘/’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.get_uid">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">get_uid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.get_uid" title="Link to this definition">#</a></dt>
<dd><p>Generate a unique identifier (UID).</p>
<p>This function generates a new unique identifier using the UUID version 4 standard,
which creates a random UUID.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string representation of the generated UUID.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.get_zip_progress">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">get_zip_progress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blob_zip_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.get_zip_progress" title="Link to this definition">#</a></dt>
<dd><p>Retrieve the progress of a zip operation by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>blob_zip_id</strong> (<em>str</em>) – The ID of the zip operation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the progress and the current item being processed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>BlobDoesNotExistError</strong></a> – If the provided blob_zip_id does not exist in the progress tracking.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.init">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.init" title="Link to this definition">#</a></dt>
<dd><p>Initializes the blob module by setting the global blob_path and deleting
all ephemeral files that are not referred to by any data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function should be called on startup, and regular restarts should
be scheduled to ensure that ephemeral files are cleaned up.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.mark_as_completed">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">mark_as_completed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">md5sum</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.mark_as_completed" title="Link to this definition">#</a></dt>
<dd><p>Marks a blob as completed in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the blob.</p></li>
<li><p><strong>size</strong> (<em>int</em>) – The size of the blob in bytes.</p></li>
<li><p><strong>md5sum</strong> (<em>str</em>) – The MD5 checksum of the blob.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.remove_reference">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">remove_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.remove_reference" title="Link to this definition">#</a></dt>
<dd><p>Decrements the reference count of a database object identified by the given ID.</p>
<p>If the provided ID is not a valid ObjectId, the function returns immediately.
Otherwise, it decrements the ‘references’ field of the object by 1 and ensures
that the ‘references’ field does not go below 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The ID of the database object whose reference count is to be decremented.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.save_blob_data">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">save_blob_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_unzip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ephemeral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.save_blob_data" title="Link to this definition">#</a></dt>
<dd><p>Save blob data to storage and optionally unzip if the file is a zip archive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>FileStorage</em>) – The file to be saved.</p></li>
<li><p><strong>auto_unzip</strong> (<em>bool</em>) – If True, automatically unzip the file if it is a zip archive.</p></li>
<li><p><strong>tags</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of tags to associate with the blob.</p></li>
<li><p><strong>hidden</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, mark the blob as hidden. Defaults to False.</p></li>
<li><p><strong>ephemeral</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, mark the blob as ephemeral. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries containing the unique ID and file extension of the uploaded blobs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.set_blob_ephemeral">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">set_blob_ephemeral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blob_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ephemeral</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.set_blob_ephemeral" title="Link to this definition">#</a></dt>
<dd><p>Sets the ‘ephemeral’ status of a blob in the database and returns the updated blob data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blob_id</strong> (<em>str</em>) – The unique identifier of the blob.</p></li>
<li><p><strong>ephemeral</strong> (<em>bool</em>) – The new ephemeral status to set for the blob.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated blob data with the new ephemeral status.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.set_blob_hidden">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">set_blob_hidden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blob_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.set_blob_hidden" title="Link to this definition">#</a></dt>
<dd><p>Set the hidden status of a blob in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blob_id</strong> (<em>str</em>) – The unique identifier of the blob.</p></li>
<li><p><strong>hidden</strong> (<em>bool</em>) – The hidden status to set for the blob.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated blob data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>BlobDoesNotExistError</strong></a> – If the blob with the given ID does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.set_blob_tags">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">set_blob_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blob_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.set_blob_tags" title="Link to this definition">#</a></dt>
<dd><p>Set tags for a blob in the database.</p>
<p>This function updates the tags for a blob identified by its ID. If the blob does not exist,
it raises a BlobDoesNotExistError. The tags are converted to lowercase and duplicates are removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blob_id</strong> (<em>str</em>) – The ID of the blob to update.</p></li>
<li><p><strong>tags</strong> (<em>list</em>) – A list of tags to set for the blob.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated blob data with the new tags.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>BlobDoesNotExistError</strong></a> – If the blob with the specified ID does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.set_mime_from_ext">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">set_mime_from_ext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.set_mime_from_ext" title="Link to this definition">#</a></dt>
<dd><p>Sets the MIME type based on the file extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mime</strong> (<em>str</em>) – The initial MIME type.</p></li>
<li><p><strong>ext</strong> (<em>str</em>) – The file extension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated MIME type based on the file extension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.sum_blob_size">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">sum_blob_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.sum_blob_size" title="Link to this definition">#</a></dt>
<dd><p>Calculate the total size of blobs that match the given filter for a specific user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.blobsearchfilter.BlobSearchFilter" title="application.types.blobsearchfilter.BlobSearchFilter"><em>BlobSearchFilter</em></a>) – The filter criteria to search for blobs.</p></li>
<li><p><strong>user_id</strong> (<em>ObjectId</em>) – The ID of the user whose blobs are being queried.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The total size of the blobs that match the filter.</dt><dd><p>Returns 0 if the user does not exist or no blobs match the filter.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.unzip_file_into_blobs">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">unzip_file_into_blobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ephemeral</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.unzip_file_into_blobs" title="Link to this definition">#</a></dt>
<dd><p>Unzips a ZIP archive and creates blobs from each file inside.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Path to the ZIP file to be extracted.</p></li>
<li><p><strong>tags</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of tags to associate with each created blob.</p></li>
<li><p><strong>hidden</strong> (<em>bool</em>) – Whether the created blobs should be marked as hidden.</p></li>
<li><p><strong>ephemeral</strong> (<em>bool</em>) – Whether the created blobs should be marked as ephemeral.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries, each containing the ‘id’ and ‘ext’ of a created blob.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.blob.zip_matching_blobs">
<span class="sig-prename descclassname"><span class="pre">application.db.blob.</span></span><span class="sig-name descname"><span class="pre">zip_matching_blobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blob_zip_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.blob.zip_matching_blobs" title="Link to this definition">#</a></dt>
<dd><p>Create a ZIP archive of blobs that match the given filter and user ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.blobsearchfilter.BlobSearchFilter" title="application.types.blobsearchfilter.BlobSearchFilter"><em>BlobSearchFilter</em></a>) – The filter criteria to match blobs.</p></li>
<li><p><strong>user_id</strong> (<em>ObjectId</em>) – The ID of the user requesting the ZIP archive.</p></li>
<li><p><strong>blob_zip_id</strong> (<em>str</em>) – A unique identifier for the ZIP archive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Information about the created ZIP blob, including its ID.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>exceptions.BlobDoesNotExistError</strong></a> – If the created ZIP blob does not exist in the database.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.book">
<span id="application-db-book-module"></span><h2>application.db.book module<a class="headerlink" href="#module-application.db.book" title="Link to this heading">#</a></h2>
<p>application.db.book</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.append_ebook">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">append_ebook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">book_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebook_url</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.append_ebook" title="Link to this definition">#</a></dt>
<dd><p>Append an ebook to the book’s ebook list and update the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>book_id</strong> (<em>str</em>) – The unique identifier of the book.</p></li>
<li><p><strong>ebook_url</strong> (<em>str</em>) – The URL of the ebook to be appended.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated book data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>exceptions.BlobDoesNotExistError</strong></a> – If the ebook URL does not exist in the blob storage.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.borrow_book">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">borrow_book</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">book_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.borrow_book" title="Link to this definition">#</a></dt>
<dd><p>Allows a user to borrow a book by updating the book’s share history and status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>book_id</strong> (<em>str</em>) – The ID of the book to be borrowed.</p></li>
<li><p><strong>user_data</strong> (<em>dict</em>) – A dictionary containing user information, including:
- ‘_id’: The user’s unique identifier.
- ‘username’: The user’s name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data of the book being borrowed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagDoesNotExistError" title="application.exceptions.BookTagDoesNotExistError"><strong>exceptions.BookTagDoesNotExistError</strong></a> – If the book with the given ID does not exist.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookCannotBeShared" title="application.exceptions.BookCannotBeShared"><strong>exceptions.BookCannotBeShared</strong></a> – If the book is currently being borrowed by another user.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.build_book_query">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">build_book_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.build_book_query" title="Link to this definition">#</a></dt>
<dd><p>Builds a MongoDB query and aggregation pipeline based on the provided filter and sort criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.booksearchfilter.BookSearchFilter" title="application.types.booksearchfilter.BookSearchFilter"><em>BookSearchFilter</em></a>) – A dictionary containing search filters for books.
- owner (str or list): The owner(s) of the book.
- author (str): The author of the book.
- genre (str): The genre of the book.
- shared (bool): Whether the book is shared.
- title (str): The title or ISBN of the book.</p></li>
<li><p><strong>sort</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of tuples specifying the sort order. Defaults to [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>aggregate (list or None): The aggregation pipeline if applicable, otherwise None.</p></li>
<li><p>query (dict): The MongoDB query dictionary.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.build_keywords">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">build_keywords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">book_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.build_keywords" title="Link to this definition">#</a></dt>
<dd><p>Extracts and builds a list of unique keywords from the given book data.</p>
<p>This function processes specific fields (‘title’, ‘subtitle’, ‘description’, ‘authors’)
from the provided book data dictionary. It tokenizes the content of these fields into
keywords and returns a sorted list of unique keywords.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>book_data</strong> (<em>dict</em>) – A dictionary containing book information. Expected keys are
‘title’, ‘subtitle’, ‘description’, and ‘authors’. The value
for ‘authors’ can be a list of strings, while the other fields
are expected to be strings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A sorted list of unique keywords extracted from the specified fields</dt><dd><p>in the book data.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.count_all_user_books">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">count_all_user_books</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_users</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.count_all_user_books" title="Link to this definition">#</a></dt>
<dd><p>Count the number of books owned by each user.</p>
<p>This function aggregates the total number of books for each user in the database.
It can also filter the results to include only specific users if a list of user IDs is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filter_users</strong> (<em>list</em><em> | </em><em>None</em>) – A list of user IDs to filter the results.
If None, all users are included.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of dictionaries, each containing the ‘owner’ information</dt><dd><p>(username and display name) and the ‘count’ of books owned by that user.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.count_books">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">count_books</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.count_books" title="Link to this definition">#</a></dt>
<dd><p>Count the number of books in the database based on the provided filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.booksearchfilter.BookSearchFilter" title="application.types.booksearchfilter.BookSearchFilter"><em>BookSearchFilter</em></a>) – The filter criteria to search for books.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The count of books that match the filter criteria.</dt><dd><p>Returns 0 if the user does not exist or no books match the criteria.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>exceptions.UserDoesNotExistError</strong></a> – If the user specified in the filter does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.create_book">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">create_book</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.create_book" title="Link to this definition">#</a></dt>
<dd><p>Creates a new book entry in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>owner</strong> (<em>str</em>) – The username of the book owner.</p></li>
<li><p><strong>data</strong> (<em>dict</em>) – A dictionary containing book information. Expected keys are:
- ‘rfid’: The RFID of the book.
- ‘title’: The title of the book.
- ‘subtitle’: The subtitle of the book.
- ‘authors’: A list of authors of the book.
- ‘publisher’: The publisher of the book.
- ‘publishedDate’: The published date of the book.
- ‘description’: A description of the book.
- ‘pageCount’: The number of pages in the book.
- ‘thumbnail’: A URL to the thumbnail image of the book.
- ‘isbn’ (optional): The ISBN of the book.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the created book data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.edit_book">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">edit_book</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.edit_book" title="Link to this definition">#</a></dt>
<dd><p>Edit the details of a book in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the book to be edited.</p></li>
<li><p><strong>new_data</strong> (<em>dict</em>) – A dictionary containing the new data for the book.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated book data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p>This function retrieves the current data of the book using its ID,
compares it with the new data provided, and updates the fields that have changed.
It also updates the ‘noSyncFields’ to include the changed fields.
Finally, it updates the book data in the database and returns the updated book data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.get_book">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">get_book</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.get_book" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a book from the database by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The ID of the book to retrieve.</p></li>
<li><p><strong>parse</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the book data will be
processed before returning. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The book data, either raw or processed based on the <cite>parse</cite> parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagDoesNotExistError" title="application.exceptions.BookTagDoesNotExistError"><strong>BookTagDoesNotExistError</strong></a> – If no book with the given ID is found in the database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.get_book_tag">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">get_book_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfid</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.get_book_tag" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a book tag from the database using its RFID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rfid</strong> (<em>str</em>) – The RFID of the book tag to retrieve.</p></li>
<li><p><strong>parse</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the book data will be
processed before returning. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The book tag data. If <cite>parse</cite> is True, the data will be processed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagDoesNotExistError" title="application.exceptions.BookTagDoesNotExistError"><strong>BookTagDoesNotExistError</strong></a> – If no book tag with the given RFID is found in the database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.get_books">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">get_books</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorting</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.get_books" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of books from the database based on
the given filter, pagination, and sorting criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.booksearchfilter.BookSearchFilter" title="application.types.booksearchfilter.BookSearchFilter"><em>BookSearchFilter</em></a>) – The filter criteria to apply to the book search.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting index for pagination.</p></li>
<li><p><strong>count</strong> (<em>int</em>) – The number of books to retrieve.</p></li>
<li><p><strong>sorting</strong> (<a class="reference internal" href="application.types.html#application.types.sorting.Sorting" title="application.types.sorting.Sorting"><em>Sorting</em></a>) – The sorting criteria, including
fields to sort by and order (ascending/descending).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of books that match the filter criteria, sorted and paginated as specified.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.keyword_tokenize">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">keyword_tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.keyword_tokenize" title="Link to this definition">#</a></dt>
<dd><p>Tokenizes the input text into a list of unique keywords.</p>
<p>This function performs the following steps:
1. Replaces apostrophes (’) with an empty string.
2. Applies a regex substitution to replace non-word characters with spaces.
3. Applies another regex substitution to replace tags with spaces.
4. Converts the text to lowercase.
5. Splits the text into words.
6. Filters out words with a length of 2 or less.
7. Removes duplicate words by converting the list to a set and back to a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text to be tokenized.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of unique keywords extracted from the input text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.link_book_tag">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">link_book_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">book_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.link_book_tag" title="Link to this definition">#</a></dt>
<dd><p>Links a book tag to a book in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>owner</strong> (<em>str</em>) – The username of the owner of the book.</p></li>
<li><p><strong>rfid</strong> (<em>str</em>) – The RFID tag to be linked to the book.</p></li>
<li><p><strong>book_id</strong> (<em>str</em>) – The ID of the book to be linked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the book data after linking the tag.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagExistsError" title="application.exceptions.BookTagExistsError"><strong>BookTagExistsError</strong></a> – If the RFID tag is already linked to a book.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.next_out_of_date_book_rfid">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">next_out_of_date_book_rfid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">before</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.next_out_of_date_book_rfid" title="Link to this definition">#</a></dt>
<dd><p>Retrieve the RFID of the next book that is out of date.</p>
<p>This function queries the database for a book whose ‘lastSync’ field is
earlier than the specified ‘before’ datetime. If such a book is found,
its RFID is returned. If no such book is found, None is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>before</strong> (<em>datetime</em>) – The cutoff datetime to find books that are out of date.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The RFID of the next out-of-date book, or None if no such book is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.norm_query">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">norm_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ownerq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.norm_query" title="Link to this definition">#</a></dt>
<dd><p>Normalize a query by combining it with an owner query if provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<em>dict</em>) – The initial query dictionary.</p></li>
<li><p><strong>ownerq</strong> (<em>dict</em><em> | </em><em>None</em>) – An optional owner query dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The combined query dictionary if both query and ownerq are provided,</dt><dd><p>otherwise returns the non-None query dictionary.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.process_book_tag">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">process_book_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">book_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.process_book_tag" title="Link to this definition">#</a></dt>
<dd><p>Processes and enriches book data with additional information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>book_data</strong> (<em>dict</em>) – A dictionary containing book information.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The enriched book data dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>exceptions.UserDoesNotExistError</strong></a> – If the user does not exist.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BlobDoesNotExistError" title="application.exceptions.BlobDoesNotExistError"><strong>exceptions.BlobDoesNotExistError</strong></a> – If the blob does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.process_share_hist">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">process_share_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">share_history</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.process_share_hist" title="Link to this definition">#</a></dt>
<dd><p>Processes a list of share history records and updates the display name for each record.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>share_history</strong> (<em>list</em>) – A list of dictionaries, where each dictionary represents
a share history record. Each record must contain ‘user_id’ and ‘name’ keys.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of dictionaries with updated ‘display_name’ keys.</dt><dd><p>If ‘user_id’ is None, ‘display_name’ is set to ‘name’.
If ‘user_id’ is not None, ‘display_name’ is set to the display name of the user.
If the user does not exist, ‘display_name’ is set to ‘name’.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.refresh_book_data">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">refresh_book_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.refresh_book_data" title="Link to this definition">#</a></dt>
<dd><p>Refreshes the book data in the database using the provided RFID.</p>
<p>This function retrieves the book data from the database using the RFID,
fetches updated book information from the Google Books API, and updates
the database with the new information. If the book data does not exist
in the database, it raises a BookTagDoesNotExistError.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rfid</strong> (<em>str</em>) – The RFID of the book to refresh.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagDoesNotExistError" title="application.exceptions.BookTagDoesNotExistError"><strong>BookTagDoesNotExistError</strong></a> – If the book data does not exist in the database.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.return_book">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">return_book</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">book_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.return_book" title="Link to this definition">#</a></dt>
<dd><p>Return a borrowed book to the library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>book_id</strong> (<em>str</em>) – The ID of the book to be returned.</p></li>
<li><p><strong>user_data</strong> (<em>dict</em>) – The data of the user returning the book, containing at least the user’s ID.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data of the book being returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagDoesNotExistError" title="application.exceptions.BookTagDoesNotExistError"><strong>BookTagDoesNotExistError</strong></a> – If the book with the given ID does not exist.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookCannotBeShared" title="application.exceptions.BookCannotBeShared"><strong>BookCannotBeShared</strong></a> – If the book is not currently shared or if the user did not borrow the book.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.set_book_owner">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">set_book_owner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.set_book_owner" title="Link to this definition">#</a></dt>
<dd><p>Updates the owner of a book and records the ownership history.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the book.</p></li>
<li><p><strong>username</strong> (<em>str</em>) – The username of the new owner.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated book data including the new owner and ownership history.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.share_book_with_non_user">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">share_book_with_non_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">book_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.share_book_with_non_user" title="Link to this definition">#</a></dt>
<dd><p>Share a book with a non-user by updating the book’s share history.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>book_id</strong> (<em>str</em>) – The ID of the book to be shared.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the non-user with whom the book is being shared.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The book data after the share operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagDoesNotExistError" title="application.exceptions.BookTagDoesNotExistError"><strong>exceptions.BookTagDoesNotExistError</strong></a> – If the book with the given ID does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.share_book_with_user">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">share_book_with_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">book_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.share_book_with_user" title="Link to this definition">#</a></dt>
<dd><p>Marke a book as shared (with a user), updating the book’s share history.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>book_id</strong> (<em>str</em>) – The ID of the book to be shared.</p></li>
<li><p><strong>username</strong> (<em>str</em>) – The username of the user with whom the book is being shared.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The book data after the share operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagDoesNotExistError" title="application.exceptions.BookTagDoesNotExistError"><strong>exceptions.BookTagDoesNotExistError</strong></a> – If the book with the given ID does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.book.unlink_book_tag">
<span class="sig-prename descclassname"><span class="pre">application.db.book.</span></span><span class="sig-name descname"><span class="pre">unlink_book_tag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.book.unlink_book_tag" title="Link to this definition">#</a></dt>
<dd><p>Unlink a book tag from the database using its RFID.</p>
<p>This function searches for a book in the database using the provided RFID.
If the book is found, it deletes the book entry from the database and removes
any reference to its thumbnail if it is a locally hosted blob.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rfid</strong> (<em>str</em>) – The RFID of the book to be unlinked.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data of the book that was unlinked.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BookTagDoesNotExistError" title="application.exceptions.BookTagDoesNotExistError"><strong>BookTagDoesNotExistError</strong></a> – If no book with the given RFID is found in the database.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.bugs">
<span id="application-db-bugs-module"></span><h2>application.db.bugs module<a class="headerlink" href="#module-application.db.bugs" title="Link to this heading">#</a></h2>
<p>application.db.bugs</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.bugs.comment_on_bug">
<span class="sig-prename descclassname"><span class="pre">application.db.bugs.</span></span><span class="sig-name descname"><span class="pre">comment_on_bug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plaintext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.bugs.comment_on_bug" title="Link to this definition">#</a></dt>
<dd><p>Add a comment to a bug report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the bug report.</p></li>
<li><p><strong>text</strong> (<em>str</em>) – The content of the comment.</p></li>
<li><p><strong>plaintext</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the comment is treated as plain text.
If False, the comment is treated as Markdown. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated bug report.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BugReportDoesNotExistError" title="application.exceptions.BugReportDoesNotExistError"><strong>BugReportDoesNotExistError</strong></a> – If the bug report with the given id does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.bugs.count_bug_reports">
<span class="sig-prename descclassname"><span class="pre">application.db.bugs.</span></span><span class="sig-name descname"><span class="pre">count_bug_reports</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolved</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.bugs.count_bug_reports" title="Link to this definition">#</a></dt>
<dd><p>Count the number of bug reports based on the given user IDs and resolution status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>userids</strong> (<em>list</em>) – A list of user IDs to filter the bug reports. If the list is empty,
the count will be based only on the resolution status.</p></li>
<li><p><strong>resolved</strong> (<em>bool</em>) – The resolution status to filter the bug reports.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The count of bug reports that match the given criteria.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.bugs.delete_bug_report">
<span class="sig-prename descclassname"><span class="pre">application.db.bugs.</span></span><span class="sig-name descname"><span class="pre">delete_bug_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.bugs.delete_bug_report" title="Link to this definition">#</a></dt>
<dd><p>Deletes a bug report from the database by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The ID of the bug report to delete.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deleted bug report with its ID included.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BugReportDoesNotExistError" title="application.exceptions.BugReportDoesNotExistError"><strong>BugReportDoesNotExistError</strong></a> – If no bug report with the given ID exists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.bugs.get_bug_report">
<span class="sig-prename descclassname"><span class="pre">application.db.bugs.</span></span><span class="sig-name descname"><span class="pre">get_bug_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.bugs.get_bug_report" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a bug report from the database by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The unique identifier of the bug report.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed bug report data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BugReportDoesNotExistError" title="application.exceptions.BugReportDoesNotExistError"><strong>BugReportDoesNotExistError</strong></a> – If no bug report with the given ID is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.bugs.get_bug_reports">
<span class="sig-prename descclassname"><span class="pre">application.db.bugs.</span></span><span class="sig-name descname"><span class="pre">get_bug_reports</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolved</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.bugs.get_bug_reports" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of bug reports from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>userids</strong> (<em>list</em>) – A list of user IDs to filter the bug reports by creator.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting index for pagination.</p></li>
<li><p><strong>count</strong> (<em>int</em>) – The number of bug reports to retrieve.</p></li>
<li><p><strong>resolved</strong> (<em>bool</em>) – A flag indicating whether to retrieve resolved or unresolved bug reports.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of processed bug reports.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.bugs.process_bug_report">
<span class="sig-prename descclassname"><span class="pre">application.db.bugs.</span></span><span class="sig-name descname"><span class="pre">process_bug_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">report</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.bugs.process_bug_report" title="Link to this definition">#</a></dt>
<dd><p>Prepares a bug report database item for display by
populating the report’s creator and comments with usernames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>report</strong> (<em>dict</em>) – A dictionary containing the bug report details.
Expected keys are ‘_id’, ‘creator’, and ‘convo’.
‘convo’ is a list of comments, each with a ‘creator’ key.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The processed bug report with updated ‘id’, ‘creator’, and ‘convo’ fields.</dt><dd><p>The ‘id’ field is set to the value of ‘_id’.
The ‘creator’ field is updated to the username if the user exists,
otherwise it is converted to a string.
Each comment’s ‘creator’ field is similarly updated.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.bugs.report_bug">
<span class="sig-prename descclassname"><span class="pre">application.db.bugs.</span></span><span class="sig-name descname"><span class="pre">report_bug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plaintext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.bugs.report_bug" title="Link to this definition">#</a></dt>
<dd><p>Report a new bug to the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>str</em>) – The content of the bug report.</p></li>
<li><p><strong>plaintext</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the text is treated as plain text and escaped for HTML.
If False, the text is treated as Markdown and converted to HTML.
Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the bug report details, including the newly assigned bug report ID.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.bugs.set_bug_status">
<span class="sig-prename descclassname"><span class="pre">application.db.bugs.</span></span><span class="sig-name descname"><span class="pre">set_bug_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.bugs.set_bug_status" title="Link to this definition">#</a></dt>
<dd><p>Update the status of a bug report and notify the creator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the bug report.</p></li>
<li><p><strong>status</strong> (<em>bool</em>) – The new status of the bug report. True for resolved, False for reopened.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated bug report.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BugReportDoesNotExistError" title="application.exceptions.BugReportDoesNotExistError"><strong>exceptions.BugReportDoesNotExistError</strong></a> – If the bug report with the given id does not exist.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.datafeed">
<span id="application-db-datafeed-module"></span><h2>application.db.datafeed module<a class="headerlink" href="#module-application.db.datafeed" title="Link to this heading">#</a></h2>
<p>application.db.datafeed</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.count_documents">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">count_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.count_documents" title="Link to this definition">#</a></dt>
<dd><p>Count the number of documents in the database for a given feed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feed</strong> (<em>str</em>) – The feed identifier, expected to be a valid ObjectId.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The number of documents associated with the given feed.</dt><dd><p>Returns 0 if the feed identifier is not valid.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.count_feeds">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">count_feeds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.count_feeds" title="Link to this definition">#</a></dt>
<dd><p>Count the number of documents in the ‘feeds’ collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The total number of documents in the ‘feeds’ collection.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.create_document">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">create_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">author</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.create_document" title="Link to this definition">#</a></dt>
<dd><p>Create a new document in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feed</strong> (<em>str</em>) – The feed identifier.</p></li>
<li><p><strong>author</strong> (<em>str</em><em> | </em><em>None</em>) – The author of the document. Can be None.</p></li>
<li><p><strong>posted</strong> (<em>datetime</em><em> | </em><em>None</em>) – The date and time the document was posted. Can be None.</p></li>
<li><p><strong>body</strong> (<em>str</em>) – The body content of the document.</p></li>
<li><p><strong>title</strong> (<em>str</em><em> | </em><em>None</em>) – The title of the document. Can be None.</p></li>
<li><p><strong>url</strong> (<em>str</em>) – The URL of the document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed document from the database.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.create_feed">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">create_feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notify</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.create_feed" title="Link to this definition">#</a></dt>
<dd><p>Creates a new feed in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the feed.</p></li>
<li><p><strong>url</strong> (<em>str</em>) – The URL of the feed.</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – The kind of the feed. Must be ‘markdown_recursive’.</p></li>
<li><p><strong>notify</strong> (<em>bool</em>) – Whether to notify users about the feed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created feed data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.InvalidFeedKindError" title="application.exceptions.InvalidFeedKindError"><strong>InvalidFeedKindError</strong></a> – If the kind is not ‘markdown_recursive’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.delete_feed">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">delete_feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.delete_feed" title="Link to this definition">#</a></dt>
<dd><p>Deletes a feed and its associated documents from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The unique identifier of the feed to be deleted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary representation of the deleted feed after processing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.FeedDoesNotExistError" title="application.exceptions.FeedDoesNotExistError"><strong>FeedDoesNotExistError</strong></a> – If the feed with the given id does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.get_body_html">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">get_body_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed_kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.get_body_html" title="Link to this definition">#</a></dt>
<dd><p>Converts the given body text to HTML based on the specified feed kind.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feed_kind</strong> (<em>str</em>) – The type of feed to process. Currently supports ‘markdown_recursive’.</p></li>
<li><p><strong>body</strong> (<em>str</em>) – The body text to be converted to HTML.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted HTML string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.InvalidFeedKindError" title="application.exceptions.InvalidFeedKindError"><strong>InvalidFeedKindError</strong></a> – If the provided feed kind is not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.get_document">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">get_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.get_document" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a document from the database by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The ID of the document to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed document.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.FeedDocumentDoesNotExistError" title="application.exceptions.FeedDocumentDoesNotExistError"><strong>FeedDocumentDoesNotExistError</strong></a> – If the document does not exist or the ID is invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.get_documents">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">get_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorting</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.get_documents" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of documents from the database based on
the specified feed, starting index, count, and sorting order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feed</strong> (<em>str</em>) – The ID of the feed to retrieve documents from.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting index of the documents to retrieve.</p></li>
<li><p><strong>count</strong> (<em>int</em>) – The number of documents to retrieve.</p></li>
<li><p><strong>sorting</strong> (<a class="reference internal" href="application.types.html#application.types.sorting.Sorting" title="application.types.sorting.Sorting"><em>Sorting</em></a>) – The sorting criteria for the documents. It should be a dictionary with ‘fields’
as a list of field names and ‘descending’ as a boolean indicating the sort order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of documents matching the specified criteria.</dt><dd><p>Each document is represented as a dictionary.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.get_feed">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">get_feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.get_feed" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a feed from the database by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The ID of the feed to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed feed data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.FeedDoesNotExistError" title="application.exceptions.FeedDoesNotExistError"><strong>FeedDoesNotExistError</strong></a> – If the provided ID is not valid or if no feed is found with the given ID.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.get_feeds">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">get_feeds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.get_feeds" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of processed feeds from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>int</em>) – The starting index from which to retrieve feeds.</p></li>
<li><p><strong>count</strong> (<em>int</em>) – The number of feeds to retrieve.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries, each representing a processed feed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.get_user_feeds">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">get_user_feeds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.get_user_feeds" title="Link to this definition">#</a></dt>
<dd><p>Retrieve the feeds created by a specific user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user whose feeds are to be retrieved.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries, each representing a feed created by the user.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.process_document">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">process_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">document</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.process_document" title="Link to this definition">#</a></dt>
<dd><p>Processes a document by copying the value of the ‘_id’ key to a new ‘id’ key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>document</strong> (<em>dict</em>) – The document to be processed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed document with the ‘id’ key added.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.process_feed">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">process_feed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.process_feed" title="Link to this definition">#</a></dt>
<dd><p>Processes a feed dictionary by updating its ‘id’ and ‘creator’ fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feed</strong> (<em>dict</em>) – The feed dictionary to be processed. It must contain ‘_id’ and ‘creator’ keys.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed feed dictionary with ‘id’ and ‘creator’ fields updated.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user with the given ‘creator’ ID does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.set_document_read">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">set_document_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.set_document_read" title="Link to this definition">#</a></dt>
<dd><p>Sets the ‘read’ status of a document in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the document.</p></li>
<li><p><strong>read</strong> (<em>bool</em>) – The read status to set for the document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated document with the new ‘read’ status.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.set_feed_inactive">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">set_feed_inactive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inactive</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.set_feed_inactive" title="Link to this definition">#</a></dt>
<dd><p>Sets the ‘inactive’ status of a feed in the database.</p>
<p>If the feed is set to inactive, new documents will not be fetched and added to the feed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the feed.</p></li>
<li><p><strong>inactive</strong> (<em>bool</em>) – The status to set for the feed’s ‘inactive’ field.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated feed document with the new ‘inactive’ status.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.set_feed_navigation">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">set_feed_navigation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorting</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.set_feed_navigation" title="Link to this definition">#</a></dt>
<dd><p>Updates the navigation settings for a specific feed in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the feed.</p></li>
<li><p><strong>page</strong> (<em>int</em><em> | </em><em>None</em>) – The current page number to set for the feed. Can be None.</p></li>
<li><p><strong>sorting</strong> (<a class="reference internal" href="application.types.html#application.types.sorting.Sorting" title="application.types.sorting.Sorting"><em>Sorting</em></a><em> | </em><em>None</em>) – The sorting criteria to set for the feed. Can be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated feed with the new navigation settings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.set_feed_notify">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">set_feed_notify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notify</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.set_feed_notify" title="Link to this definition">#</a></dt>
<dd><p>Updates the notification setting for a specific feed and returns the updated feed data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The unique identifier of the feed.</p></li>
<li><p><strong>notify</strong> (<em>bool</em>) – The new notification setting for the feed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated feed data with the new notification setting.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.datafeed.update_document">
<span class="sig-prename descclassname"><span class="pre">application.db.datafeed.</span></span><span class="sig-name descname"><span class="pre">update_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.datafeed.update_document" title="Link to this definition">#</a></dt>
<dd><p>Update the body of a document in the database.</p>
<p>This function retrieves a document by its ID, updates its body and body_html fields,
and sets the updated timestamp to the current UTC time. The updated document is then
saved back to the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>) – The ID of the document to update.</p></li>
<li><p><strong>body</strong> (<em>str</em>) – The new body content for the document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated document.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.inventory">
<span id="application-db-inventory-module"></span><h2>application.db.inventory module<a class="headerlink" href="#module-application.db.inventory" title="Link to this heading">#</a></h2>
<p>application.db.inventory</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.build_inventory_query">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">build_inventory_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.build_inventory_query" title="Link to this definition">#</a></dt>
<dd><p>Builds a MongoDB query dictionary for searching inventory based on the provided filter and user ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.inventorysearchfilter.InventorySearchFilter" title="application.types.inventorysearchfilter.InventorySearchFilter"><em>InventorySearchFilter</em></a>) – An object containing search criteria for the inventory.</p></li>
<li><p><strong>user_id</strong> (<em>ObjectId</em>) – The ID of the user making the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A MongoDB query dictionary constructed based on the provided filter criteria.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.count_inventory">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">count_inventory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.count_inventory" title="Link to this definition">#</a></dt>
<dd><p>Count the number of inventory items based on the provided filter and user ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.inventorysearchfilter.InventorySearchFilter" title="application.types.inventorysearchfilter.InventorySearchFilter"><em>InventorySearchFilter</em></a>) – The filter criteria to apply to the inventory search.</p></li>
<li><p><strong>user_id</strong> (<em>ObjectId</em>) – The ID of the user whose inventory is being queried.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The number of inventory items that match the filter criteria for the specified user.</dt><dd><p>Returns 0 if the user does not exist.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>exceptions.UserDoesNotExistError</strong></a> – If the user does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.create_inventory_item">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">create_inventory_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blob_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.create_inventory_item" title="Link to this definition">#</a></dt>
<dd><p>Create a new inventory item in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>owner</strong> (<em>str</em>) – The username of the owner of the item.</p></li>
<li><p><strong>category</strong> (<em>str</em>) – The category of the item.</p></li>
<li><p><strong>type</strong> (<em>str</em>) – The type of the item.</p></li>
<li><p><strong>location</strong> (<em>str</em>) – The location of the item.</p></li>
<li><p><strong>blob_id</strong> (<em>str</em>) – The ID of the associated blob.</p></li>
<li><p><strong>description</strong> (<em>str</em>) – A textual description of the item.</p></li>
<li><p><strong>rfid</strong> (<em>str</em><em> | </em><em>None</em>) – The RFID tag of the item, if any.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created inventory item.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.ItemExistsError" title="application.exceptions.ItemExistsError"><strong>exceptions.ItemExistsError</strong></a> – If an item with the given RFID already exists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.delete_inventory_item">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">delete_inventory_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.delete_inventory_item" title="Link to this definition">#</a></dt>
<dd><p>Deletes an inventory item from the database by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The ID of the inventory item to be deleted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deleted inventory item details.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the inventory item with the given ID does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.get_inventory">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">get_inventory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorting</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.get_inventory" title="Link to this definition">#</a></dt>
<dd><p>Retrieves a list of inventory items based on the provided filter, pagination, and sorting options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<a class="reference internal" href="application.types.html#application.types.inventorysearchfilter.InventorySearchFilter" title="application.types.inventorysearchfilter.InventorySearchFilter"><em>InventorySearchFilter</em></a>) – The filter criteria to apply to the inventory search.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting index for pagination.</p></li>
<li><p><strong>count</strong> (<em>int</em>) – The number of items to retrieve.</p></li>
<li><p><strong>sorting</strong> (<a class="reference internal" href="application.types.html#application.types.sorting.Sorting" title="application.types.sorting.Sorting"><em>Sorting</em></a>) – The sorting criteria for the inventory items.</p></li>
<li><p><strong>user_id</strong> (<em>ObjectId</em>) – The ID of the user making the request.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of inventory items matching the search criteria.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>exceptions.UserDoesNotExistError</strong></a> – If the user specified in the filter does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.get_inventory_item">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">get_inventory_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.get_inventory_item" title="Link to this definition">#</a></dt>
<dd><p>Retrieve an inventory item from the database by its ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The ID of the inventory item to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary representing the inventory item.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.ItemDoesNotExistError" title="application.exceptions.ItemDoesNotExistError"><strong>exceptions.ItemDoesNotExistError</strong></a> – If no item with the given ID is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.get_item_categories">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">get_item_categories</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.get_item_categories" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of distinct item categories from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of unique item categories.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.get_item_locations">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">get_item_locations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.get_item_locations" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of distinct item locations for a given owner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>owner</strong> (<em>str</em>) – The username of the owner whose item locations are to be retrieved.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of distinct locations where the owner’s items are stored.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.inventory.get_item_types">
<span class="sig-prename descclassname"><span class="pre">application.db.inventory.</span></span><span class="sig-name descname"><span class="pre">get_item_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.inventory.get_item_types" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of distinct item types for a given category from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>category</strong> (<em>str</em>) – The category of items to filter by.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of distinct item types within the specified category.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.notification">
<span id="application-db-notification-module"></span><h2>application.db.notification module<a class="headerlink" href="#module-application.db.notification" title="Link to this heading">#</a></h2>
<p>application.db.notification</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.count_notifications">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">count_notifications</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.count_notifications" title="Link to this definition">#</a></dt>
<dd><p>Count the number of notifications for a given user based on their read status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user whose notifications are to be counted.</p></li>
<li><p><strong>read</strong> (<em>bool</em>) – The read status of the notifications to be counted (True for read, False for unread).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of notifications that match the given criteria.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.create_subscription">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">create_subscription</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subscription_token</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.create_subscription" title="Link to this definition">#</a></dt>
<dd><p>Create a notification subscription for a user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>subscription_token</strong> (<em>dict</em>) – <p>A dictionary containing the subscription token details.
Expected keys are:</p>
<blockquote>
<div><ul>
<li><p>’endpoint’ (str): The endpoint URL of the subscription.</p></li>
<li><p>’expirationTime’ (str | None): The expiration time of the subscription.</p></li>
<li><dl class="simple">
<dt>’keys’ (dict): A dictionary containing the keys for the subscription.</dt><dd><dl class="simple">
<dt>Expected keys are:</dt><dd><ul>
<li><p>’p256dh’ (str): The p256dh key.</p></li>
<li><p>’auth’ (str): The auth key.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.InvalidSubscriptionToken" title="application.exceptions.InvalidSubscriptionToken"><strong>exceptions.InvalidSubscriptionToken</strong></a> – If the subscription token is invalid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.delete_subscription">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">delete_subscription</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auth</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.delete_subscription" title="Link to this definition">#</a></dt>
<dd><p>Deletes all notification subscriptions from the database that match the given authentication token.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>auth</strong> (<em>str</em>) – The authentication token used to identify subscriptions to delete.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of subscriptions deleted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.delete_subscriptions">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">delete_subscriptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.delete_subscriptions" title="Link to this definition">#</a></dt>
<dd><p>Delete all notification subscription records for a given user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user whose subscriptions are to be deleted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of subscription records that were deleted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.get_notifications">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">get_notifications</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.get_notifications" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of notifications for a given user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the recipient.</p></li>
<li><p><strong>read</strong> (<em>bool</em>) – Filter notifications based on their read status.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting index for pagination.</p></li>
<li><p><strong>count</strong> (<em>int</em>) – The number of notifications to retrieve.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of notifications, each represented as a dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.get_public_key">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">get_public_key</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.get_public_key" title="Link to this definition">#</a></dt>
<dd><p>Retrieve the VAPID public key.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The VAPID public key as a string.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.get_subscription">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">get_subscription</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auth</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.get_subscription" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a notification subscription token from the database using the provided authentication key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>auth</strong> (<em>str</em>) – The authentication key used to find the subscription.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The subscription token if found, otherwise None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.get_subscriptions">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">get_subscriptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.get_subscriptions" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of notification subscription tokens for a given user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user whose subscriptions are to be retrieved.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of subscription tokens associated with the user.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.get_user_from_notif">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">get_user_from_notif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.get_user_from_notif" title="Link to this definition">#</a></dt>
<dd><p>Retrieve user information based on a notification ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>str</em>) – The ID of the notification.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing user information if found, otherwise an empty dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.init">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.init" title="Link to this definition">#</a></dt>
<dd><p>Initialize the notification module by loading VAPID keys from the data directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.mark_all_as_read">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">mark_all_as_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.mark_all_as_read" title="Link to this definition">#</a></dt>
<dd><p>Marks all notifications as read for a given user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user whose notifications are to be marked as read.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.mark_as_read">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">mark_as_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.mark_as_read" title="Link to this definition">#</a></dt>
<dd><p>Marks a notification as read in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item_id</strong> (<em>str</em>) – The unique identifier of the notification to be marked as read.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.send">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'general'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.send" title="Link to this definition">#</a></dt>
<dd><p>Send a notification to a user and log the notification in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – The title of the notification.</p></li>
<li><p><strong>body</strong> (<em>str</em>) – The body content of the notification.</p></li>
<li><p><strong>username</strong> (<em>str</em>) – The username of the recipient.</p></li>
<li><p><strong>category</strong> (<em>str</em><em>, </em><em>optional</em>) – The category of the notification. Defaults to ‘general’.</p></li>
<li><p><strong>read</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the notification is marked as read. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the logged notification data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.MissingConfig" title="application.exceptions.MissingConfig"><strong>exceptions.MissingConfig</strong></a> – If the admin email configuration is missing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.notification.try_send_webpush">
<span class="sig-prename descclassname"><span class="pre">application.db.notification.</span></span><span class="sig-name descname"><span class="pre">try_send_webpush</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subscription_token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">admin_email</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.notification.try_send_webpush" title="Link to this definition">#</a></dt>
<dd><p>Attempts to send a web push notification to a user and handles exceptions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the notification recipient.</p></li>
<li><p><strong>subscription_token</strong> (<em>dict</em>) – The web push subscription information for the user.</p></li>
<li><p><strong>message</strong> (<em>dict</em>) – The notification message payload to send.</p></li>
<li><p><strong>admin_email</strong> (<em>str</em>) – The administrator’s email address for VAPID claims.</p></li>
<li><p><strong>endpoint</strong> (<em>str</em>) – The endpoint URL for the push service.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the notification was sent successfully, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.perms">
<span id="application-db-perms-module"></span><h2>application.db.perms module<a class="headerlink" href="#module-application.db.perms" title="Link to this heading">#</a></h2>
<p>application.db.perms</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.perms.require">
<span class="sig-prename descclassname"><span class="pre">application.db.perms.</span></span><span class="sig-name descname"><span class="pre">require</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">perms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perform_on_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.perms.require" title="Link to this definition">#</a></dt>
<dd><p>Require the calling user to have any of the specified permissions.</p>
<p>This is a decorator for application resolvers,
to avoid redundant permission-checking logic all over the place.
If the permissions are not satisfied when the resolver is called,
then the resolver will be overridden and will instead return a bad_perms() dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*perms</strong> (<em>str</em>) – The permissions that must have at least 1 satisfied.</p></li>
<li><p><strong>perform_on_self</strong> (<em>bool</em><em> | </em><em>tuple</em><em>[</em><em>bool</em><em>, </em><em>...</em><em>]</em>) – If True, permissions will be ignored
when the user is editing their own data.</p></li>
<li><p><strong>data_func</strong> (<em>Callable</em><em>|</em><em>None</em>) – If specified, this function will give
the data to be checked for ownership. Otherwise, the main function’s
parameters are checked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resolver function, with decorator applied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.sessions">
<span id="application-db-sessions-module"></span><h2>application.db.sessions module<a class="headerlink" href="#module-application.db.sessions" title="Link to this heading">#</a></h2>
<p>application.db.sessions</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.sessions.count_valid_sessions">
<span class="sig-prename descclassname"><span class="pre">application.db.sessions.</span></span><span class="sig-name descname"><span class="pre">count_valid_sessions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.sessions.count_valid_sessions" title="Link to this definition">#</a></dt>
<dd><p>Count the number of valid sessions for a given username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username to count sessions for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of valid sessions associated with the username.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.sessions.get_first_session_token">
<span class="sig-prename descclassname"><span class="pre">application.db.sessions.</span></span><span class="sig-name descname"><span class="pre">get_first_session_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.sessions.get_first_session_token" title="Link to this definition">#</a></dt>
<dd><p>Retrieve the first session token for a given username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username to search for in the database.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The session token if found, otherwise None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.sessions.revoke_sessions">
<span class="sig-prename descclassname"><span class="pre">application.db.sessions.</span></span><span class="sig-name descname"><span class="pre">revoke_sessions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.sessions.revoke_sessions" title="Link to this definition">#</a></dt>
<dd><p>Revoke all sessions for a given username.</p>
<p>This function deletes all session records associated with the specified username
from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username whose sessions are to be revoked.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.sessions.start_session">
<span class="sig-prename descclassname"><span class="pre">application.db.sessions.</span></span><span class="sig-name descname"><span class="pre">start_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.sessions.start_session" title="Link to this definition">#</a></dt>
<dd><p>Starts a new session for the given user.</p>
<p>This function retrieves user data for the specified username and creates a new session
in the database with the provided token. The session expiry time is determined based
on the user’s permissions. Persistent logins last for 20 weeks, while non-persistent
logins last for 7 days.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> (<em>str</em>) – The session token.</p></li>
<li><p><strong>username</strong> (<em>str</em>) – The username of the user starting the session.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.sessions.valid_session">
<span class="sig-prename descclassname"><span class="pre">application.db.sessions.</span></span><span class="sig-name descname"><span class="pre">valid_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.sessions.valid_session" title="Link to this definition">#</a></dt>
<dd><p>Check if a session with the given token exists in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token</strong> (<em>str</em>) – The session token to validate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if a session with the token exists, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.settings">
<span id="application-db-settings-module"></span><h2>application.db.settings module<a class="headerlink" href="#module-application.db.settings" title="Link to this heading">#</a></h2>
<p>application.db.settings</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.calculate_disabled_modules">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">calculate_disabled_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disabled_modules</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.calculate_disabled_modules" title="Link to this definition">#</a></dt>
<dd><p>Calculate the complete list of disabled modules based on the provided list of disabled modules
and the module configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>disabled_modules</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of module IDs that are initially disabled.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of module IDs that are disabled, including those that are</dt><dd><p>indirectly disabled due to dependencies.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.create_theme">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">create_theme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theme</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.create_theme" title="Link to this definition">#</a></dt>
<dd><p>Creates or updates a theme in the database.</p>
<p>If a theme with the same name already exists, it updates the existing theme.
Otherwise, it inserts a new theme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theme</strong> (<em>dict</em>) – A dictionary containing the theme details.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The theme that was created or updated.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.delete_theme">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">delete_theme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.delete_theme" title="Link to this definition">#</a></dt>
<dd><p>Deletes a theme from the database by its name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the theme to delete.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deleted theme document.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.MissingConfig" title="application.exceptions.MissingConfig"><strong>exceptions.MissingConfig</strong></a> – If the theme with the specified name does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.get_all_configs">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">get_all_configs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.get_all_configs" title="Link to this definition">#</a></dt>
<dd><p>Retrieve all configuration entries from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A list of dictionaries, each containing ‘name’ and ‘value’ keys</dt><dd><p>representing the configuration entries.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.get_all_themes">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">get_all_themes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.get_all_themes" title="Link to this definition">#</a></dt>
<dd><p>Retrieve all themes from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of all themes found in the database.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.get_config">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.get_config" title="Link to this definition">#</a></dt>
<dd><p>Retrieve the configuration value for a given configuration name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the configuration to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the configuration if found, otherwise None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.get_enabled_modules">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">get_enabled_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.get_enabled_modules" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of enabled modules, optionally
filtering out those disabled for a specific user or group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_data</strong> (<em>dict</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – A dictionary containing user-specific data,
including disabled modules and groups. Defaults to None.</p></li>
<li><p><strong>group</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – A specific group to consider for disabled modules. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of enabled modules, excluding those disabled for the specified user or group.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.get_groups">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">get_groups</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.get_groups" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of user groups from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of groups if the ‘groups’ document is found, otherwise an empty list.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.get_modules">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">get_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.get_modules" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of modules available to a user,
excluding any disabled modules based on the user’s groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>user_data</strong> (<em>dict</em>) – A dictionary containing user information, including their groups.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of enabled modules for the user, excluding any disabled modules.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.set_config">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">set_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.set_config" title="Link to this definition">#</a></dt>
<dd><p>Sets or deletes a configuration value in the database.</p>
<p>If the value is None, the configuration entry with the given name is deleted.
Otherwise, the configuration entry is updated or created with the provided value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the configuration setting.</p></li>
<li><p><strong>value</strong> (<em>str</em><em> | </em><em>None</em>) – The value to set for the configuration setting.
If None, the setting is deleted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.set_module_enabled">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">set_module_enabled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enabled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.set_module_enabled" title="Link to this definition">#</a></dt>
<dd><p>Enable or disable a module in the database.</p>
<p>If a group is specified, the module’s enabled/disabled state is updated within that group.
Otherwise, the module’s state is updated globally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module_id</strong> (<em>str</em>) – The ID of the module to be enabled or disabled.</p></li>
<li><p><strong>enabled</strong> (<em>bool</em>) – True to enable the module, False to disable it.</p></li>
<li><p><strong>group</strong> (<em>str</em><em> | </em><em>None</em>) – The group within which to update the module’s state.
If None, the global state is updated.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.settings.update_groups">
<span class="sig-prename descclassname"><span class="pre">application.db.settings.</span></span><span class="sig-name descname"><span class="pre">update_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_groups</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.settings.update_groups" title="Link to this definition">#</a></dt>
<dd><p>Updates the user counts for groups in the database based on the provided old and new group lists.</p>
<p>If the ‘groups’ document does not exist in the database, it creates a new one with the new groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_groups</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of group names that the user was previously a member of.</p></li>
<li><p><strong>new_groups</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of group names that the user is currently a member of.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.users">
<span id="application-db-users-module"></span><h2>application.db.users module<a class="headerlink" href="#module-application.db.users" title="Link to this heading">#</a></h2>
<p>application.db.users</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.authenticate">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">authenticate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.authenticate" title="Link to this definition">#</a></dt>
<dd><p>Authenticates the user with the specified username and password.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>password</strong> (<em>str</em>) – The password of the user.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A login token if authentication is successful.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.AuthenticationError" title="application.exceptions.AuthenticationError"><strong>AuthenticationError</strong></a> – If authentication fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.count_users">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">count_users</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.count_users" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The count of all non-ephemeral users.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.create_user">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">create_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">admin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ephemeral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.create_user" title="Link to this definition">#</a></dt>
<dd><p>Creates a new user with the specified username, password,
groups, admin status, and ephemeral status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the new user.</p></li>
<li><p><strong>password</strong> (<em>str</em>) – The password of the new user.</p></li>
<li><p><strong>groups</strong> (<em>list</em><em>, </em><em>optional</em>) – List of groups the user belongs to. Defaults to [].</p></li>
<li><p><strong>admin</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the user is an admin. Defaults to False.</p></li>
<li><p><strong>ephemeral</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the user is ephemeral. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The created user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BadUserNameError" title="application.exceptions.BadUserNameError"><strong>BadUserNameError</strong></a> – If the username is empty.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserExistsError" title="application.exceptions.UserExistsError"><strong>UserExistsError</strong></a> – If the user already exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.delete_user">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">delete_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.delete_user" title="Link to this definition">#</a></dt>
<dd><p>Deletes the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user to delete.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deleted user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.dump_collection">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">dump_collection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.dump_collection" title="Link to this definition">#</a></dt>
<dd><p>Exports documents from a specified MongoDB collection based on provided queries
and writes them to a ZipFile as JSON.
Any sensitive information, such as passwords, is excluded from the export.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>collection</strong> (<em>str</em>) – The name of the MongoDB collection to export.</p></li>
<li><p><strong>queries</strong> (<em>list</em>) – A list of query dictionaries to filter documents for export.</p></li>
<li><p><strong>fp</strong> (<em>ZipFile</em>) – An open ZipFile object to which the exported JSON will be written.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.export_user_data">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">export_user_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.export_user_data" title="Link to this definition">#</a></dt>
<dd><p>Exports the user data for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A blob containing the exported data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.get_admins">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">get_admins</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.get_admins" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of all admin users.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.get_user_by_id">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">get_user_by_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.get_user_by_id" title="Link to this definition">#</a></dt>
<dd><p>Returns user data for the user with the specified ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>ObjectId</em>) – The ID of the user.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.get_user_data">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">get_user_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.get_user_data" title="Link to this definition">#</a></dt>
<dd><p>Returns user data for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.get_user_list">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">get_user_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groups</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.get_user_list" title="Link to this definition">#</a></dt>
<dd><p>Returns a list of users with their username, display name, and last login.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>groups</strong> (<em>list</em><em>, </em><em>optional</em>) – List of groups to filter users by. Defaults to [].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of users.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.group_filter">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">group_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.group_filter" title="Link to this definition">#</a></dt>
<dd><p>Applies group filtering to the specified filter based on the user’s groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<em>Filter</em>) – The filter to apply group filtering to.</p></li>
<li><p><strong>user_data</strong> (<em>dict</em>) – The user data containing the groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated filter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.update_user_display_name">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">update_user_display_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.update_user_display_name" title="Link to this definition">#</a></dt>
<dd><p>Updates the display name for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>display_name</strong> (<em>str</em>) – The new display name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BadUserNameError" title="application.exceptions.BadUserNameError"><strong>BadUserNameError</strong></a> – If the username is empty.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.update_user_email">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">update_user_email</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.update_user_email" title="Link to this definition">#</a></dt>
<dd><p>Updates the email for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>email</strong> (<em>str</em>) – The new email.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BadUserNameError" title="application.exceptions.BadUserNameError"><strong>BadUserNameError</strong></a> – If the username is empty.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.update_user_groups">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">update_user_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.update_user_groups" title="Link to this definition">#</a></dt>
<dd><p>Updates the groups for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>groups</strong> (<em>list</em>) – The new groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BadUserNameError" title="application.exceptions.BadUserNameError"><strong>BadUserNameError</strong></a> – If the username is empty.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.update_user_module">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">update_user_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disabled</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.update_user_module" title="Link to this definition">#</a></dt>
<dd><p>Updates the disabled modules for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>module</strong> (<em>str</em>) – The module to update.</p></li>
<li><p><strong>disabled</strong> (<em>bool</em>) – Whether the module is disabled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BadUserNameError" title="application.exceptions.BadUserNameError"><strong>BadUserNameError</strong></a> – If the username is empty.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.update_user_password">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">update_user_password</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.update_user_password" title="Link to this definition">#</a></dt>
<dd><p>Updates the password for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>password</strong> (<em>str</em>) – The new password.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BadUserNameError" title="application.exceptions.BadUserNameError"><strong>BadUserNameError</strong></a> – If the username is empty.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.update_user_perms">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">update_user_perms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.update_user_perms" title="Link to this definition">#</a></dt>
<dd><p>Updates the permissions for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>perms</strong> (<em>list</em>) – The new permissions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.update_user_theme">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">update_user_theme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theme</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.update_user_theme" title="Link to this definition">#</a></dt>
<dd><p>Updates the theme for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user.</p></li>
<li><p><strong>theme</strong> (<em>dict</em>) – The new theme data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.update_username">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">update_username</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.update_username" title="Link to this definition">#</a></dt>
<dd><p>Updates the username for the user with the specified username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The current username of the user.</p></li>
<li><p><strong>new_username</strong> (<em>str</em>) – The new username.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.BadUserNameError" title="application.exceptions.BadUserNameError"><strong>BadUserNameError</strong></a> – If the new username is empty.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user is not found.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserExistsError" title="application.exceptions.UserExistsError"><strong>UserExistsError</strong></a> – If the new username already exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.users.userids_in_groups">
<span class="sig-prename descclassname"><span class="pre">application.db.users.</span></span><span class="sig-name descname"><span class="pre">userids_in_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groups</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.users.userids_in_groups" title="Link to this definition">#</a></dt>
<dd><p>Returns a list of user IDs for users in the specified groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>groups</strong> (<em>list</em>) – List of groups to filter users by.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of user IDs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db.weather">
<span id="application-db-weather-module"></span><h2>application.db.weather module<a class="headerlink" href="#module-application.db.weather" title="Link to this heading">#</a></h2>
<p>application.db.weather</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.count_alert_history">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">count_alert_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.count_alert_history" title="Link to this definition">#</a></dt>
<dd><p>Count the number of alert history documents in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em><em> | </em><em>None</em>) – The username to filter the alert history by.
If None, count all alert history documents.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The count of alert history documents matching the criteria.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.create_user">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">create_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.create_user" title="Link to this definition">#</a></dt>
<dd><p>Creates a new weather user in the database.</p>
<p>This function first checks if the user exists in the main users collection.
If the user does not exist, it raises a UserDoesNotExistError.
If the user already exists in the weather_users collection, it raises a UserExistsError.</p>
<p>The function then processes the ‘max’ and ‘min’ fields in the user_data to determine
their values based on the ‘disable’ and ‘default’ flags.</p>
<p>Finally, it inserts the new user data into the weather_users collection and returns
the processed weather user data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>user_data</strong> (<em>dict</em>) – A dictionary containing user information. Expected keys are:
- ‘username’ (str): The username of the user.
- ‘lat’ (float): The latitude of the user’s location.
- ‘lon’ (float): The longitude of the user’s location.
- ‘max’ (dict): A dictionary with ‘disable’ (bool) and ‘default’ (bool) keys.
- ‘min’ (dict): A dictionary with ‘disable’ (bool) and ‘default’ (bool) keys.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed weather user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user does not exist in the main users collection.</p></li>
<li><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserExistsError" title="application.exceptions.UserExistsError"><strong>UserExistsError</strong></a> – If the user already exists in the weather_users collection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.delete_user">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">delete_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.delete_user" title="Link to this definition">#</a></dt>
<dd><p>Delete a user from the weather database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user to be deleted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The user’s previous (now nonexistent) weather information.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.get_alert_history">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">get_alert_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.get_alert_history" title="Link to this definition">#</a></dt>
<dd><p>Retrieve a list of alert history records from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em><em> | </em><em>None</em>) – The username to filter the alert history by.
If None, retrieves all alert history.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting index for the records to retrieve.</p></li>
<li><p><strong>count</strong> (<em>int</em>) – The number of records to retrieve.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of dictionaries containing alert history records. Each dictionary contains:</dt><dd><ul class="simple">
<li><p>’recipient’ (str): The recipient of the alert.</p></li>
<li><p>’message’ (str): The message content of the alert.</p></li>
<li><p>’sent’ (datetime): The timestamp when the alert was sent.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.get_last_exec">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">get_last_exec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.get_last_exec" title="Link to this definition">#</a></dt>
<dd><p>Retrieves the most recent weather log entry from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The most recent weather log entry as a dictionary if it exists,</dt><dd><p>otherwise None.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.get_users">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">get_users</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.get_users" title="Link to this definition">#</a></dt>
<dd><p>Retrieve and process weather users from the database.</p>
<p>This function fetches all weather users from the <cite>db.weather_users</cite> collection,
processes each user using the <cite>process_weather_user</cite> function, and returns a
sorted list of processed users. The sorting is based on the concatenation of
the integer value of the ‘exclude’ field and the ‘username’ field.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A sorted list of processed weather users.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.get_weather_user">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">get_weather_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.get_weather_user" title="Link to this definition">#</a></dt>
<dd><p>Retrieve weather user data from the database based on the provided username.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<em>str</em>) – The username of the user whose weather data is to be retrieved.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the weather user data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="application.exceptions.html#application.exceptions.UserDoesNotExistError" title="application.exceptions.UserDoesNotExistError"><strong>UserDoesNotExistError</strong></a> – If the user with the given username does not exist in the database.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.log_user_weather_alert">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">log_user_weather_alert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.log_user_weather_alert" title="Link to this definition">#</a></dt>
<dd><p>Logs a weather alert message for a user.</p>
<p>This function updates the last sent time for the user’s weather alert
and logs the alert message in the alert history.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the user to log the alert for.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – The weather alert message to log.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.log_weather_alert">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">log_weather_alert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.log_weather_alert" title="Link to this definition">#</a></dt>
<dd><p>Logs a weather alert to the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>users</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of user identifiers who are affected by the weather alert.</p></li>
<li><p><strong>error</strong> (<em>str</em><em> | </em><em>None</em>) – An optional error message if there was an issue with the weather alert.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.process_weather_user">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">process_weather_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userdata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.process_weather_user" title="Link to this definition">#</a></dt>
<dd><p>Processes the weather-related user data.</p>
<p>This function takes a dictionary containing user data, validates the user ID,
retrieves additional user information from the database if necessary, and
processes the ‘max’ and ‘min’ weather values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>userdata</strong> (<em>dict</em>) – A dictionary containing user data. Expected keys are:
- ‘_id’: The user ID, which should be a valid ObjectId.
- ‘max’: The maximum weather value (optional, should be a float).
- ‘min’: The minimum weather value (optional, should be a float).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The processed user data dictionary with the following keys:</dt><dd><ul class="simple">
<li><p>’username’: The username associated with the user ID, or the user ID itself if not found.</p></li>
<li><dl class="simple">
<dt>’max’: A dictionary with the following keys:</dt><dd><ul>
<li><p>’value’: The maximum weather value (float).</p></li>
<li><p>’default’: A boolean indicating if the ‘max’ value was not provided.</p></li>
<li><p>’disable’: A boolean indicating if the ‘max’ value is explicitly set to False.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’min’: A dictionary with the following keys:</dt><dd><ul>
<li><p>’value’: The minimum weather value (float).</p></li>
<li><p>’default’: A boolean indicating if the ‘min’ value was not provided.</p></li>
<li><p>’disable’: A boolean indicating if the ‘min’ value is explicitly set to False.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.set_user_excluded">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">set_user_excluded</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.set_user_excluded" title="Link to this definition">#</a></dt>
<dd><p>Updates the exclusion status of a weather user and processes the updated user data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> (<em>str</em>) – The username of the weather user.</p></li>
<li><p><strong>exclude</strong> (<em>bool</em>) – The exclusion status to be set for the user.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed user data after updating the exclusion status.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.weather.update_user">
<span class="sig-prename descclassname"><span class="pre">application.db.weather.</span></span><span class="sig-name descname"><span class="pre">update_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.weather.update_user" title="Link to this definition">#</a></dt>
<dd><p>Updates the weather information for a user in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>user_data</strong> (<em>dict</em>) – <p>A dictionary containing user data with the following keys:
- ‘username’ (str): The username of the user.
- ‘lat’ (float): The latitude of the user’s location.
- ‘lon’ (float): The longitude of the user’s location.
- ‘max’ (dict): A dictionary with keys ‘disable’, ‘default’,</p>
<blockquote>
<div><p>and ‘value’ for the maximum temperature settings.</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>’min’ (dict): A dictionary with keys ‘disable’, ‘default’,</dt><dd><p>and ‘value’ for the minimum temperature settings.</p>
</dd>
</dl>
</li>
<li><p>’_id’ (Any): The unique identifier of the user in the database.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The user’s updated weather information.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-application.db">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-application.db" title="Link to this heading">#</a></h2>
<p>application.db</p>
<dl class="py function">
<dt class="sig sig-object py" id="application.db.init_db">
<span class="sig-prename descclassname"><span class="pre">application.db.</span></span><span class="sig-name descname"><span class="pre">init_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_db_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blob_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#application.db.init_db" title="Link to this definition">#</a></dt>
<dd><p>Initialize the database connections and set up the necessary collections.</p>
<p>This function connects to the MongoDB instance specified by <cite>data_db_url</cite> and
initializes various collections used by the application. It also sets the path
for blob storage if provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_db_url</strong> (<em>str</em>) – The URL of the MongoDB instance to connect to. Defaults to ‘localhost’.</p></li>
<li><p><strong>blob_path</strong> (<em>str</em><em>, </em><em>optional</em>) – The path for blob storage. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="application.db.setup_db">
<span class="sig-prename descclassname"><span class="pre">application.db.</span></span><span class="sig-name descname"><span class="pre">setup_db</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#application.db.setup_db" title="Link to this definition">#</a></dt>
<dd><p>Sets up the database by performing the following actions:</p>
<ol class="arabic simple">
<li><p>Attempts to create a temporary admin user.</p></li>
<li><p>Creates necessary indexes for the database to function properly.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="application.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">application package</p>
      </div>
    </a>
    <a class="right-next"
       href="application.exceptions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">application.exceptions package</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.apikeys">application.db.apikeys module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.apikeys.delete_api_key"><code class="docutils literal notranslate"><span class="pre">delete_api_key()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.apikeys.get_api_keys"><code class="docutils literal notranslate"><span class="pre">get_api_keys()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.apikeys.new_api_key"><code class="docutils literal notranslate"><span class="pre">new_api_key()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.apikeys.valid_api_key"><code class="docutils literal notranslate"><span class="pre">valid_api_key()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.blob">application.db.blob module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.add_reference"><code class="docutils literal notranslate"><span class="pre">add_reference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.build_blob_query"><code class="docutils literal notranslate"><span class="pre">build_blob_query()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.cancel_zip"><code class="docutils literal notranslate"><span class="pre">cancel_zip()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.count_blobs"><code class="docutils literal notranslate"><span class="pre">count_blobs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.count_tag_uses"><code class="docutils literal notranslate"><span class="pre">count_tag_uses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.create_blob"><code class="docutils literal notranslate"><span class="pre">create_blob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.create_blob_previews"><code class="docutils literal notranslate"><span class="pre">create_blob_previews()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.create_preview_model"><code class="docutils literal notranslate"><span class="pre">create_preview_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.create_preview_video"><code class="docutils literal notranslate"><span class="pre">create_preview_video()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.delete_blob"><code class="docutils literal notranslate"><span class="pre">delete_blob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.file_info"><code class="docutils literal notranslate"><span class="pre">file_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.get_blob_data"><code class="docutils literal notranslate"><span class="pre">get_blob_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.get_blobs"><code class="docutils literal notranslate"><span class="pre">get_blobs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.get_tags_from_mime"><code class="docutils literal notranslate"><span class="pre">get_tags_from_mime()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.get_uid"><code class="docutils literal notranslate"><span class="pre">get_uid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.get_zip_progress"><code class="docutils literal notranslate"><span class="pre">get_zip_progress()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.init"><code class="docutils literal notranslate"><span class="pre">init()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.mark_as_completed"><code class="docutils literal notranslate"><span class="pre">mark_as_completed()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.remove_reference"><code class="docutils literal notranslate"><span class="pre">remove_reference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.save_blob_data"><code class="docutils literal notranslate"><span class="pre">save_blob_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.set_blob_ephemeral"><code class="docutils literal notranslate"><span class="pre">set_blob_ephemeral()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.set_blob_hidden"><code class="docutils literal notranslate"><span class="pre">set_blob_hidden()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.set_blob_tags"><code class="docutils literal notranslate"><span class="pre">set_blob_tags()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.set_mime_from_ext"><code class="docutils literal notranslate"><span class="pre">set_mime_from_ext()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.sum_blob_size"><code class="docutils literal notranslate"><span class="pre">sum_blob_size()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.unzip_file_into_blobs"><code class="docutils literal notranslate"><span class="pre">unzip_file_into_blobs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.blob.zip_matching_blobs"><code class="docutils literal notranslate"><span class="pre">zip_matching_blobs()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.book">application.db.book module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.append_ebook"><code class="docutils literal notranslate"><span class="pre">append_ebook()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.borrow_book"><code class="docutils literal notranslate"><span class="pre">borrow_book()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.build_book_query"><code class="docutils literal notranslate"><span class="pre">build_book_query()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.build_keywords"><code class="docutils literal notranslate"><span class="pre">build_keywords()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.count_all_user_books"><code class="docutils literal notranslate"><span class="pre">count_all_user_books()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.count_books"><code class="docutils literal notranslate"><span class="pre">count_books()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.create_book"><code class="docutils literal notranslate"><span class="pre">create_book()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.edit_book"><code class="docutils literal notranslate"><span class="pre">edit_book()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.get_book"><code class="docutils literal notranslate"><span class="pre">get_book()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.get_book_tag"><code class="docutils literal notranslate"><span class="pre">get_book_tag()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.get_books"><code class="docutils literal notranslate"><span class="pre">get_books()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.keyword_tokenize"><code class="docutils literal notranslate"><span class="pre">keyword_tokenize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.link_book_tag"><code class="docutils literal notranslate"><span class="pre">link_book_tag()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.next_out_of_date_book_rfid"><code class="docutils literal notranslate"><span class="pre">next_out_of_date_book_rfid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.norm_query"><code class="docutils literal notranslate"><span class="pre">norm_query()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.process_book_tag"><code class="docutils literal notranslate"><span class="pre">process_book_tag()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.process_share_hist"><code class="docutils literal notranslate"><span class="pre">process_share_hist()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.refresh_book_data"><code class="docutils literal notranslate"><span class="pre">refresh_book_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.return_book"><code class="docutils literal notranslate"><span class="pre">return_book()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.set_book_owner"><code class="docutils literal notranslate"><span class="pre">set_book_owner()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.share_book_with_non_user"><code class="docutils literal notranslate"><span class="pre">share_book_with_non_user()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.share_book_with_user"><code class="docutils literal notranslate"><span class="pre">share_book_with_user()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.book.unlink_book_tag"><code class="docutils literal notranslate"><span class="pre">unlink_book_tag()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.bugs">application.db.bugs module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.bugs.comment_on_bug"><code class="docutils literal notranslate"><span class="pre">comment_on_bug()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.bugs.count_bug_reports"><code class="docutils literal notranslate"><span class="pre">count_bug_reports()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.bugs.delete_bug_report"><code class="docutils literal notranslate"><span class="pre">delete_bug_report()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.bugs.get_bug_report"><code class="docutils literal notranslate"><span class="pre">get_bug_report()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.bugs.get_bug_reports"><code class="docutils literal notranslate"><span class="pre">get_bug_reports()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.bugs.process_bug_report"><code class="docutils literal notranslate"><span class="pre">process_bug_report()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.bugs.report_bug"><code class="docutils literal notranslate"><span class="pre">report_bug()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.bugs.set_bug_status"><code class="docutils literal notranslate"><span class="pre">set_bug_status()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.datafeed">application.db.datafeed module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.count_documents"><code class="docutils literal notranslate"><span class="pre">count_documents()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.count_feeds"><code class="docutils literal notranslate"><span class="pre">count_feeds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.create_document"><code class="docutils literal notranslate"><span class="pre">create_document()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.create_feed"><code class="docutils literal notranslate"><span class="pre">create_feed()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.delete_feed"><code class="docutils literal notranslate"><span class="pre">delete_feed()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.get_body_html"><code class="docutils literal notranslate"><span class="pre">get_body_html()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.get_document"><code class="docutils literal notranslate"><span class="pre">get_document()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.get_documents"><code class="docutils literal notranslate"><span class="pre">get_documents()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.get_feed"><code class="docutils literal notranslate"><span class="pre">get_feed()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.get_feeds"><code class="docutils literal notranslate"><span class="pre">get_feeds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.get_user_feeds"><code class="docutils literal notranslate"><span class="pre">get_user_feeds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.process_document"><code class="docutils literal notranslate"><span class="pre">process_document()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.process_feed"><code class="docutils literal notranslate"><span class="pre">process_feed()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.set_document_read"><code class="docutils literal notranslate"><span class="pre">set_document_read()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.set_feed_inactive"><code class="docutils literal notranslate"><span class="pre">set_feed_inactive()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.set_feed_navigation"><code class="docutils literal notranslate"><span class="pre">set_feed_navigation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.set_feed_notify"><code class="docutils literal notranslate"><span class="pre">set_feed_notify()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.datafeed.update_document"><code class="docutils literal notranslate"><span class="pre">update_document()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.inventory">application.db.inventory module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.build_inventory_query"><code class="docutils literal notranslate"><span class="pre">build_inventory_query()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.count_inventory"><code class="docutils literal notranslate"><span class="pre">count_inventory()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.create_inventory_item"><code class="docutils literal notranslate"><span class="pre">create_inventory_item()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.delete_inventory_item"><code class="docutils literal notranslate"><span class="pre">delete_inventory_item()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.get_inventory"><code class="docutils literal notranslate"><span class="pre">get_inventory()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.get_inventory_item"><code class="docutils literal notranslate"><span class="pre">get_inventory_item()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.get_item_categories"><code class="docutils literal notranslate"><span class="pre">get_item_categories()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.get_item_locations"><code class="docutils literal notranslate"><span class="pre">get_item_locations()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.inventory.get_item_types"><code class="docutils literal notranslate"><span class="pre">get_item_types()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.notification">application.db.notification module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.count_notifications"><code class="docutils literal notranslate"><span class="pre">count_notifications()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.create_subscription"><code class="docutils literal notranslate"><span class="pre">create_subscription()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.delete_subscription"><code class="docutils literal notranslate"><span class="pre">delete_subscription()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.delete_subscriptions"><code class="docutils literal notranslate"><span class="pre">delete_subscriptions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.get_notifications"><code class="docutils literal notranslate"><span class="pre">get_notifications()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.get_public_key"><code class="docutils literal notranslate"><span class="pre">get_public_key()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.get_subscription"><code class="docutils literal notranslate"><span class="pre">get_subscription()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.get_subscriptions"><code class="docutils literal notranslate"><span class="pre">get_subscriptions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.get_user_from_notif"><code class="docutils literal notranslate"><span class="pre">get_user_from_notif()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.init"><code class="docutils literal notranslate"><span class="pre">init()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.mark_all_as_read"><code class="docutils literal notranslate"><span class="pre">mark_all_as_read()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.mark_as_read"><code class="docutils literal notranslate"><span class="pre">mark_as_read()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.send"><code class="docutils literal notranslate"><span class="pre">send()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.notification.try_send_webpush"><code class="docutils literal notranslate"><span class="pre">try_send_webpush()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.perms">application.db.perms module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.perms.require"><code class="docutils literal notranslate"><span class="pre">require()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.sessions">application.db.sessions module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.sessions.count_valid_sessions"><code class="docutils literal notranslate"><span class="pre">count_valid_sessions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.sessions.get_first_session_token"><code class="docutils literal notranslate"><span class="pre">get_first_session_token()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.sessions.revoke_sessions"><code class="docutils literal notranslate"><span class="pre">revoke_sessions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.sessions.start_session"><code class="docutils literal notranslate"><span class="pre">start_session()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.sessions.valid_session"><code class="docutils literal notranslate"><span class="pre">valid_session()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.settings">application.db.settings module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.calculate_disabled_modules"><code class="docutils literal notranslate"><span class="pre">calculate_disabled_modules()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.create_theme"><code class="docutils literal notranslate"><span class="pre">create_theme()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.delete_theme"><code class="docutils literal notranslate"><span class="pre">delete_theme()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.get_all_configs"><code class="docutils literal notranslate"><span class="pre">get_all_configs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.get_all_themes"><code class="docutils literal notranslate"><span class="pre">get_all_themes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.get_config"><code class="docutils literal notranslate"><span class="pre">get_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.get_enabled_modules"><code class="docutils literal notranslate"><span class="pre">get_enabled_modules()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.get_groups"><code class="docutils literal notranslate"><span class="pre">get_groups()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.get_modules"><code class="docutils literal notranslate"><span class="pre">get_modules()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.set_config"><code class="docutils literal notranslate"><span class="pre">set_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.set_module_enabled"><code class="docutils literal notranslate"><span class="pre">set_module_enabled()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.settings.update_groups"><code class="docutils literal notranslate"><span class="pre">update_groups()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.users">application.db.users module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.authenticate"><code class="docutils literal notranslate"><span class="pre">authenticate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.count_users"><code class="docutils literal notranslate"><span class="pre">count_users()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.create_user"><code class="docutils literal notranslate"><span class="pre">create_user()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.delete_user"><code class="docutils literal notranslate"><span class="pre">delete_user()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.dump_collection"><code class="docutils literal notranslate"><span class="pre">dump_collection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.export_user_data"><code class="docutils literal notranslate"><span class="pre">export_user_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.get_admins"><code class="docutils literal notranslate"><span class="pre">get_admins()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.get_user_by_id"><code class="docutils literal notranslate"><span class="pre">get_user_by_id()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.get_user_data"><code class="docutils literal notranslate"><span class="pre">get_user_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.get_user_list"><code class="docutils literal notranslate"><span class="pre">get_user_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.group_filter"><code class="docutils literal notranslate"><span class="pre">group_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.update_user_display_name"><code class="docutils literal notranslate"><span class="pre">update_user_display_name()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.update_user_email"><code class="docutils literal notranslate"><span class="pre">update_user_email()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.update_user_groups"><code class="docutils literal notranslate"><span class="pre">update_user_groups()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.update_user_module"><code class="docutils literal notranslate"><span class="pre">update_user_module()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.update_user_password"><code class="docutils literal notranslate"><span class="pre">update_user_password()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.update_user_perms"><code class="docutils literal notranslate"><span class="pre">update_user_perms()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.update_user_theme"><code class="docutils literal notranslate"><span class="pre">update_user_theme()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.update_username"><code class="docutils literal notranslate"><span class="pre">update_username()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.users.userids_in_groups"><code class="docutils literal notranslate"><span class="pre">userids_in_groups()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db.weather">application.db.weather module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.count_alert_history"><code class="docutils literal notranslate"><span class="pre">count_alert_history()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.create_user"><code class="docutils literal notranslate"><span class="pre">create_user()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.delete_user"><code class="docutils literal notranslate"><span class="pre">delete_user()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.get_alert_history"><code class="docutils literal notranslate"><span class="pre">get_alert_history()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.get_last_exec"><code class="docutils literal notranslate"><span class="pre">get_last_exec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.get_users"><code class="docutils literal notranslate"><span class="pre">get_users()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.get_weather_user"><code class="docutils literal notranslate"><span class="pre">get_weather_user()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.log_user_weather_alert"><code class="docutils literal notranslate"><span class="pre">log_user_weather_alert()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.log_weather_alert"><code class="docutils literal notranslate"><span class="pre">log_weather_alert()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.process_weather_user"><code class="docutils literal notranslate"><span class="pre">process_weather_user()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.set_user_excluded"><code class="docutils literal notranslate"><span class="pre">set_user_excluded()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.weather.update_user"><code class="docutils literal notranslate"><span class="pre">update_user()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-application.db">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.init_db"><code class="docutils literal notranslate"><span class="pre">init_db()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application.db.setup_db"><code class="docutils literal notranslate"><span class="pre">setup_db()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/application.db.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Zachary Westerman.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>