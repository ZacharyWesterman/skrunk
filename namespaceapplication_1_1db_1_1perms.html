<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Skrunk Server: application.db.perms Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Skrunk Server
   </div>
   <div id="projectbrief">An all-in-one database solution to help manage data and make my life easier.</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceapplication_1_1db_1_1perms.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">application.db.perms Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a422db4cce253d5903654152bbd8c942d" id="r_a422db4cce253d5903654152bbd8c942d"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceapplication_1_1db_1_1perms.html#a422db4cce253d5903654152bbd8c942d">bad_perms</a> ()</td></tr>
<tr class="separator:a422db4cce253d5903654152bbd8c942d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca82bbe2dbbe70da797de8568c9c63a8" id="r_aca82bbe2dbbe70da797de8568c9c63a8"><td class="memItemLeft" align="right" valign="top">dict[str, Any]|None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceapplication_1_1db_1_1perms.html#aca82bbe2dbbe70da797de8568c9c63a8">caller_info</a> ()</td></tr>
<tr class="separator:aca82bbe2dbbe70da797de8568c9c63a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95560ee9353072b8a4e53d1fc38e2562" id="r_a95560ee9353072b8a4e53d1fc38e2562"><td class="memItemLeft" align="right" valign="top">dict[str, Any]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceapplication_1_1db_1_1perms.html#a95560ee9353072b8a4e53d1fc38e2562">caller_info_strict</a> ()</td></tr>
<tr class="separator:a95560ee9353072b8a4e53d1fc38e2562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae287eb13111b894298137ab0c99c435d" id="r_ae287eb13111b894298137ab0c99c435d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceapplication_1_1db_1_1perms.html#ae287eb13111b894298137ab0c99c435d">user_has_perms</a> (dict user_data, tuple[str,...] perm_list)</td></tr>
<tr class="separator:ae287eb13111b894298137ab0c99c435d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad92ccee188ce04d10a30ae8c628c5596" id="r_ad92ccee188ce04d10a30ae8c628c5596"><td class="memItemLeft" align="right" valign="top">bool|dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceapplication_1_1db_1_1perms.html#ad92ccee188ce04d10a30ae8c628c5596">satisfies</a> (tuple[str,...] perms, dict data={}, *bool perform_on_self=False, Callable|None data_func=None)</td></tr>
<tr class="separator:ad92ccee188ce04d10a30ae8c628c5596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4617d4435276a7ed22259fa2cebaf5b6" id="r_a4617d4435276a7ed22259fa2cebaf5b6"><td class="memItemLeft" align="right" valign="top">Callable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceapplication_1_1db_1_1perms.html#a4617d4435276a7ed22259fa2cebaf5b6">require</a> (*str perms, bool perform_on_self=False, Callable|None data_func=None)</td></tr>
<tr class="separator:a4617d4435276a7ed22259fa2cebaf5b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f86c190d4809a768d93147cf4eb76d3" id="r_a4f86c190d4809a768d93147cf4eb76d3"><td class="memItemLeft" align="right" valign="top">Callable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceapplication_1_1db_1_1perms.html#a4f86c190d4809a768d93147cf4eb76d3">module</a> (*str modules)</td></tr>
<tr class="separator:a4f86c190d4809a768d93147cf4eb76d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad01aad28b8767cf358095f088390fe4b" id="r_ad01aad28b8767cf358095f088390fe4b"><td class="memItemLeft" align="right" valign="top"><a id="ad01aad28b8767cf358095f088390fe4b" name="ad01aad28b8767cf358095f088390fe4b"></a>
Collection&#160;</td><td class="memItemRight" valign="bottom"><b>apikeydb</b> = None</td></tr>
<tr class="memdesc:ad01aad28b8767cf358095f088390fe4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to the API key database collection. <br /></td></tr>
<tr class="separator:ad01aad28b8767cf358095f088390fe4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">application.db.perms</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a422db4cce253d5903654152bbd8c942d" name="a422db4cce253d5903654152bbd8c942d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a422db4cce253d5903654152bbd8c942d">&#9670;&#160;</a></span>bad_perms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> dict application.db.perms.bad_perms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Returns a dictionary representing an insufficient permissions error.

    Returns:
        dict: A dictionary containing the error type and message indicating
              that the user is not allowed to perform the requested action.</pre> 
</div>
</div>
<a id="aca82bbe2dbbe70da797de8568c9c63a8" name="aca82bbe2dbbe70da797de8568c9c63a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca82bbe2dbbe70da797de8568c9c63a8">&#9670;&#160;</a></span>caller_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> dict[str, Any] | None application.db.perms.caller_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Retrieves caller information based on the request token.

    The function attempts to decode the request token to extract the username.
    If decoding fails, it treats the token as an API key and retrieves the corresponding
    API key information from the database.

    Returns:
        str: The user data associated with the username if available, otherwise the API key
             information if the token is an API key. Returns None if neither is found or an
             error occurs during retrieval.</pre> 
</div>
</div>
<a id="a95560ee9353072b8a4e53d1fc38e2562" name="a95560ee9353072b8a4e53d1fc38e2562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95560ee9353072b8a4e53d1fc38e2562">&#9670;&#160;</a></span>caller_info_strict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> dict[str, Any] application.db.perms.caller_info_strict </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Retrieves caller information based on the request token.

    The function attempts to decode the request token to extract the username.
    If decoding fails, it treats the token as an API key and retrieves the corresponding
    API key information from the database.

    Returns:
        str: The user data associated with the username if available, otherwise the API key
             information if the token is an API key.

    Raises:
        exceptions.AuthenticationError: If the token is invalid or the user does not exist.
        exceptions.UserDoesNotExistError: If the user does not exist in the database.</pre> 
</div>
</div>
<a id="a4f86c190d4809a768d93147cf4eb76d3" name="a4f86c190d4809a768d93147cf4eb76d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f86c190d4809a768d93147cf4eb76d3">&#9670;&#160;</a></span>module()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Callable application.db.perms.module </td>
          <td>(</td>
          <td class="paramtype">*str&#160;</td>
          <td class="paramname"><em>modules</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Require the calling user to have all the specified modules enabled.

    This is a decorator for application resolvers, to avoid redundant module-checking logic all over the place.
    If the user does not have one or more of the specified modules enabled when the resolver is called, then the resolver will be overridden and will instead return a bad_perms() dict.

    Args:
        modules (list[str]): The modules that must ALL be enabled for the user.

    Returns:
        Callable: The resolver function, with decorator applied.</pre> 
</div>
</div>
<a id="a4617d4435276a7ed22259fa2cebaf5b6" name="a4617d4435276a7ed22259fa2cebaf5b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4617d4435276a7ed22259fa2cebaf5b6">&#9670;&#160;</a></span>require()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Callable application.db.perms.require </td>
          <td>(</td>
          <td class="paramtype">*str&#160;</td>
          <td class="paramname"><em>perms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>perform_on_self</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Callable | None &#160;</td>
          <td class="paramname"><em>data_func</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Require the calling user to have any of the specified permissions.

    This is a decorator for application resolvers, to avoid redundant permission-checking logic all over the place.
    If the permissions are not satisfied when the resolver is called, then the resolver will be overridden and will instead return a bad_perms() dict.

    Args:
        *perms (str): The permissions that must have at least 1 satisfied.
        perform_on_self (bool): If True, permissions will be ignored when the user is editing their own data.
        data_func (Callable|None): If specified, this function will give the data to be checked for ownership. Otherwise, the main function's parameters are checked.

    Returns:
        Callable: The resolver function, with decorator applied.</pre> 
</div>
</div>
<a id="ad92ccee188ce04d10a30ae8c628c5596" name="ad92ccee188ce04d10a30ae8c628c5596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad92ccee188ce04d10a30ae8c628c5596">&#9670;&#160;</a></span>satisfies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool | dict application.db.perms.satisfies </td>
          <td>(</td>
          <td class="paramtype">tuple[str, ...]&#160;</td>
          <td class="paramname"><em>perms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict &#160;</td>
          <td class="paramname"><em>data</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*bool &#160;</td>
          <td class="paramname"><em>perform_on_self</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Callable | None &#160;</td>
          <td class="paramname"><em>data_func</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check if the calling user has any of the given permissions.

    Args:
        perms (list[str]): The permissions that must have at least 1 satisfied.
        perform_on_self (bool): If True, permissions will be ignored when the user is editing their own data.
        data_func (Callable|None): If specified, this function will give the data to be checked for ownership. Otherwise, the main function's parameters are checked.

    Returns:
        bool: True if the user has all required permissions, or if perform_on_self is True AND the data being operated on belongs to the user.</pre> 
</div>
</div>
<a id="ae287eb13111b894298137ab0c99c435d" name="ae287eb13111b894298137ab0c99c435d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae287eb13111b894298137ab0c99c435d">&#9670;&#160;</a></span>user_has_perms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool application.db.perms.user_has_perms </td>
          <td>(</td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>user_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tuple[str, ...]&#160;</td>
          <td class="paramname"><em>perm_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">    Check if the user has any of the specified permissions.

    Args:
        user_data (dict): A dictionary containing user information, including a 'perms' key with a list of permissions.
        perm_list (list): A list of permissions to check against the user's permissions.

    Returns:
        bool: True if the user has any of the specified permissions, False otherwise.</pre> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceapplication.html">application</a></li><li class="navelem"><a class="el" href="namespaceapplication_1_1db.html">db</a></li><li class="navelem"><a class="el" href="namespaceapplication_1_1db_1_1perms.html">perms</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
